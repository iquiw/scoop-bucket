{
    "homepage": "https://github.com/browserpass/browserpass-native",
    "description": "Browserpass native client app",
    "license": "ISC",
    "version": "3.0.6",
    "architecture": {
        "64bit": {
            "url": "https://github.com/browserpass/browserpass-native/releases/download/3.0.6/browserpass-windows64-3.0.6.msi",
            "hash": "282186638edf47a128765a9acd4e6c6b878db2ce6ff73447bcc6bbec79a4639e"
        }
    },
    "extract_dir": "PFiles/Browserpass",
    "post_install": [
        "$appid = 'com.github.browserpass.native'",
        "$browsers = @('firefox', 'chromium')",
        "$regkeys = @('Mozilla', 'Google\\Chrome')",
        "For ($i = 0; $i -lt 2; $i++) {",
        "    $jsonpath = Join-Path -Path $dir -ChildPath ('{0}-{1}.json' -f $appid, $browsers[$i])",
        "    $jsonstr = gc (Join-Path -Path $dir ('{0}-host.json' -f $browsers[$i]))",
        "    $jsonstr -replace 'C:\\\\\\\\Program Files\\\\\\\\Browserpass\\\\\\\\browserpass-windows64.exe', ((Join-Path -Path $dir -ChildPath 'browserpass-windows64.exe' | ConvertTo-json) -replace '^\"|\"$', '') | Out-File -Encoding UTF8 $jsonpath",
        "    $regPath = 'hkcu:\\Software\\{0}\\NativeMessagingHosts' -f $regkeys[$i]",
        "    If (-NOT (Test-Path -Path $regPath)) { New-Item -Path $regPath -force }",
        "    New-Item -Path \"$regPath\\$appid\" -force",
        "    New-ItemProperty -Path \"$regPath\\$appid\"` -Name '(Default)'` -Value $jsonpath",
        "}"
    ],
    "notes": [
        "Added Windows registry items will not be deleted by uninstall.",
        "Please delete them manually."
    ],
    "checkver": "github",
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/browserpass/browserpass-native/releases/download/$version/browserpass-windows64-$version.msi"
            }
        }
    }
}
